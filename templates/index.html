<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Api Consulta Ncms</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
	<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.5/dist/umd/popper.min.js" integrity="sha384-Xe+8cL9oJa6tN/veChSP7q+mnSPaj5Bcu9mPX5F5xIGE0DVittaqT5lorf0EI7Vk" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.min.js" integrity="sha384-kjU+l4N0Yf4ZOJErLsIcvOU2qSb74wXpOhqTvwVx3OElZRweTnQ6d31fXEoRD1Jy" crossorigin="anonymous"></script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

</head>
<body>
   <header class="p-4 bg-primary text-light text-center">
   	   <h2>API Consulta NCMs</h2>
   </header>

   <div class="container">
        <div class="center">
          <div class="row">
            <div class="col-md-4 btn ">
                <a href=""> Inicio</a>
            </div>
            <div class="col-md-4 btn ">
                <a href=""> Documentação</a>
            </div>
            <div class="col-md-4 btn ">
                <a href=""> Sobre</a>
            </div>
         </div>
       </div>
   </div>
   

   <div class="text-center container p-5">
         <h3 class="display-4">Pesquisar na api</h3>
   	  <form class="form center">
   	  	<input id="search" class="form-control" type="text" name="search" placeholder="Digite o ncm antigo, sem pontos, apenas números">
   	  	<input id="button" class="btn btn-primary text light form-control" type="submit" name="" value="Buscar">
   	  </form>

   	  <div id="content" class="container p-4">
   	  	  <h4 id="text">Pesquisar por Novo Ncm</h4>
           <div id="ncms" class="p-5">
   	  	  </div>
   	  </div>
   </div>


   <script>
   	    let bt = document.getElementById("button")
   	    let field = document.getElementById("search")
   	     bt.addEventListener("click", function(event){
         event.preventDefault()
         

         $.ajax({
        type: 'GET',
        url: "https://consulta-ncm.herokuapp.com/"+field.value,
        error: function (jqXHR, textStatus, errorThrown) {
             document.getElementById("text").innerText = "Relação com esse ncm não encontrada, verifique se digitou corretamente"
        },
        success: function (data) {
           let size = data.length
           document.getElementById("text").innerText = ""
           document.getElementById("text").innerText = "O(s) novo(s) codigo(s) para o ncm "+field.value + " são:"
           document.getElementById("ncms").innerHTML = ""
           
           for(let pos = 0; pos < size; pos++)
           {
             let code = "<h4>"+data[pos].code+"<h4>"      
             document.getElementById("ncms").innerHTML += code
           }
           
        }
    });
});

   </script>
</body>
</html>